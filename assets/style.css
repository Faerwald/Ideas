:root{--bg:#0b0d12;--fg:#e9eef2;--muted:#a5b3c3;--card:#131722;--line:#1d2230;--accent:#6aa0ff}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif}
a{color:var(--accent);text-decoration:none}

/* Layout */
.hero{padding:2rem 1rem;max-width:1200px;margin:0 auto}
.hero h1{font-size:2rem;margin:0 0 .5rem}
.lede{color:var(--muted);max-width:80ch}

.layout{display:grid;grid-template-columns:260px 1fr;gap:1rem;max-width:1200px;margin:0 auto;padding:0 1rem 2rem}
#sidebar h3{margin:.5rem 0 0;color:var(--muted)}

.topics{display:flex;flex-wrap:wrap;gap:.5rem;margin:.75rem 0 1rem}
.chip{padding:.45rem .8rem;background:var(--card);color:var(--fg);border:1px solid var(--line);border-radius:999px;cursor:pointer}
.chip[aria-pressed="true"]{outline:2px solid var(--accent)}

.toolbar{display:grid;grid-template-columns:1fr auto auto;align-items:center;gap:.75rem;margin-bottom:.75rem}
#q{padding:.8rem 1rem;border:1px solid var(--line);background:var(--card);color:var(--fg);border-radius:.75rem;width:100%}
.counts{color:var(--muted)}
.view-toggle{display:flex;align-items:center;gap:.5rem}

/* Cards */
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1rem}
.card{background:var(--card);border:1px solid var(--line);border-radius:1rem;padding:1rem;display:grid;gap:.5rem}
.card h2{margin:0;font-size:1.05rem}
.meta{color:var(--muted);margin:0}
.tag{font-size:.8rem;color:var(--muted);border:1px dashed var(--line);padding:.15rem .5rem;border-radius:999px}
.actions{display:flex;gap:.5rem;flex-wrap:wrap}
.btn{display:inline-block;padding:.5rem .8rem;border-radius:.6rem;background:var(--accent);color:#081227;font-weight:600}
.btn.ghost{background:transparent;color:var(--fg);border:1px solid var(--line)}

.footer{border-top:1px solid var(--line);color:var(--muted);max-width:1200px;margin:1rem auto;padding:1rem}

/* Table */
#tablewrap{background:transparent;border:1px solid var(--line);border-radius:.75rem;overflow-x:auto}
table.data{width:100%;border-collapse:collapse;min-width:720px}
.data th,.data td{padding:.75rem;border-bottom:1px solid var(--line);vertical-align:middle}
.data th{color:var(--muted);font-weight:600;text-align:left;white-space:nowrap}
.data td.title{word-break:break-word}
.data th[data-key="title"], .data td.title{width:42%}
.data th[data-key="year"], .data td.year{width:7%}
.data th[data-key="category"], .data td.category{width:16%}
.data th[data-key="pages"], .data td.pages{width:8%}
.data th[data-key="wait"], .data td.wait{width:6%;text-align:center}
.data th[data-key="locked"], .data td.locked{width:6%;text-align:center}
.data th[data-key="tags"], .data td.tags{width:15%}
.data th[data-key="actions"], .data td.actions{width:14%;white-space:nowrap}

/* ---------- View control (CSS defaults + JS classes) ---------- */
/* Default (desktop): show table until JS decides */
#tablewrap{display:block}
#grid{display:none}

/* Mobile/coarse-pointer default: show cards without user tap (even before JS) */
@media (max-width:980px), (pointer:coarse){
  #tablewrap{display:none}
  #grid{display:grid}
}

/* Once JS sets an explicit view, these classes take precedence on all sizes */
body.view-table #tablewrap{display:block !important}
body.view-table #grid{display:none !important}
body.view-cards #tablewrap{display:none !important}
body.view-cards #grid{display:grid !important}

/* Responsive tweaks */
@media (max-width:980px){
  .layout{grid-template-columns:1fr}
  #sidebar{order:-1}
  .toolbar{grid-template-columns:1fr auto}
  .hero h1{font-size:1.8rem}
  .lede{font-size:.95rem}
}
@media (max-width:560px){
  html,body{font-size:15px}
  .chip{padding:.4rem .7rem}
  .data th,.data td{padding:.6rem}
}
